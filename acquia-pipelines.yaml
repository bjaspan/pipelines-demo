version: 1.0.0

events:
  build:
    steps:
      # Install npm and the ng CLI tool.
      - node:
          script:
            - nvm install node
            - nvm use node
            - npm i -g angular-cli
      # Install dependencies and build the app into a temp directory.
      - build:
          script:
            - set -x
            - npm install
            - ng build -prod --progress --output-path=/tmp/build
      # Put the build and .htaccess into docroot.
      - copy_dist:
          script:
            - set -x
            - rm -rf ./docroot
            - mkdir ./docroot
            - cp -r /tmp/build/* ./docroot
            - cp .htaccess ./docroot
